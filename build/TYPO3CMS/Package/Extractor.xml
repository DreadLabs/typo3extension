<?xml version="1.0" encoding="UTF-8"?>
<project name="TYPO3CMS.Package.Extractor">
	<target name="run">
		<condition property="extractCommand" value="tar xzf ../.buildCache/typo3cms${typo3.cms.version}.pkg --strip-components=1 --directory ../www/">
			<or>
				<equals arg1="${typo3.cms.format}" arg2="" />
				<equals arg1="${typo3.cms.format}" arg2="tar" />
			</or>
		</condition>

		<!--
			@see http://superuser.com/a/573624
			temp=$(mktemp -d) && unzip -d "$temp" ../.buildCache/typo3cms${typo3.cms.version}.pkg && mv "$temp"/*/* ../www/ && rmdir "$temp"/* "$temp"
		-->
		<condition property="extractCommand" value="temp=$(mktemp -d) &amp;&amp; unzip -d &quot;$temp&quot; ../.buildCache/typo3cms${typo3.cms.version}.pkg &amp;&amp; mv &quot;$temp&quot;/*/* ../www/ &amp;&amp; rmdir &quot;$temp&quot;/* &quot;$temp&quot;">
			<equals arg1="${typo3.cms.format}" arg2="zip" />
		</condition>

		<fail unless="extractCommand" message="The specified format (${typo3.cms.format}) is not supported!" />

		<exec command="${extractCommand}" checkreturn="true" />

		<echo>The package was successfully extracted.</echo>
	</target>
</project>