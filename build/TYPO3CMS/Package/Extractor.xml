<?xml version="1.0" encoding="UTF-8"?>
<project name="TYPO3CMS.Package.Extractor">
	<target name="run">
		<condition property="extractCommand" value="tar xzf www/typo3cms.pkg --strip-components=1">
			<or>
				<equals arg1="${typo3.cms.format}" arg2="" />
				<equals arg1="${typo3.cms.format}" arg2="tar" />
			</or>
		</condition>

		<!--
			@see http://superuser.com/a/573624
			temp=$(mktemp -d) && unzip -d "$temp" www/typo3cms.pkg && mv "$temp"/*/* www/ && rmdir "$temp"/* "$temp"
		-->
		<condition property="extractCommand" value="temp=$(mktemp -d) &amp;&amp; unzip -d &quot;$temp&quot; www/typo3cms.pkg &amp;&amp; mv &quot;$temp&quot;/*/* www/ &amp;&amp; rmdir &quot;$temp&quot;/* &quot;$temp&quot;">
			<equals arg1="${typo3.cms.format}" arg2="zip" />
		</condition>

		<fail unless="extractCommand" message="The specified format (${typo3.cms.format}) is not supported!" />

		<exec command="${extractCommand}" outputProperty="extractProgress" checkreturn="true" />

		<echo>${extractProgress}</echo>
	</target>
</project>